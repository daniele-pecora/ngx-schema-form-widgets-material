<!--
Element 'form'
 - split               : true|false = set if fields should be split up in two colums
 - ignoreParentSplit   : true|false = ignores the split property of the parent .
                                      Keeps positioning the fields in columns style and
                                      avoids creating nested blocks with columns
  - asCard             : true|false (default:false) = show or don't show card layout
  - showErrors         : true|false
                         or object of type:
                                  {
                                      position  : top|bottom, (default:top)   // shows the messages at top or at the bottom
                                      all       : true|false, (default:false) // show also children's error messages
                                      firstOnly : true|false, (default:false) // show only the first error message
                                      codes     : string[],   ([])            // show only error messages that match any of this error codes, leave empty to show all errors
                                   }

- nopad            : When <code>true</code> the padding for the first level children will be removed
- splitSizeLeft    : Defines the width of the left column when <code>"split": true</code>
                     The left and right column share a value of <code>12</code> so that is what
                     the total of both should max be.
- splitSizeRight   : Defines the width of the right column when <code>"split": true</code>
                     The left and right column share a value of <code>12</code> so that is what
                     the total of both should max be.

Element 'button'
 - label       : label
 - description : tooltip
 - id          : style id
 - disabled    : true|false|'valid'|'invalid' = disabled state, or form is in/valid
 - severity    : primary|secondary|success|info|warning|danger = primeng ui-button severity suffix
 - icon        : icon from primeng ultima
 - iconPos     : left|right = primeng button icon position
 - inline      : true|false = show horizontally inlined

        Element 'link'
            see documentation of _widget-link/widget-link.component.ts
-->

<ngx-ui-validation-messages *ngIf="formProperty.schema.widget?.showErrors && formProperty.schema.widget?.showErrors?.position!=='bottom'" [formComponent]="this"></ngx-ui-validation-messages>

<div class="{{formProperty.schema?.widget?.asCard?'ui-g card card-w-title':''}}">
  <div *ngFor="let fieldset of formProperty.schema.fieldsets">
    <h3 class="ui-g-12" *ngIf="fieldset.title || fieldset.name">{{fieldset.title || fieldset.name}}
      <ngx-ui-widget-required-mark [formProperty]="formProperty"></ngx-ui-widget-required-mark>
    </h3>
    <h5 class="ui-g-12" *ngIf="fieldset.description">{{fieldset.description}}</h5>

    <div *ngIf="schema.widget.split===true">
      <div *ngFor="let fieldId of fieldset.fields;let i = index">
        <sf-form-element
          class="ui-sm-12 ui-g-{{i%2===0 ? formProperty?.schema?.widget?.splitLeft : formProperty?.schema?.widget?.splitRight}} test-{{i%2}}"
          [class.ui-g-6]="(!formProperty?.schema?.widget?.splitLeft && !formProperty?.schema?.widget?.splitRight) && !(formProperty.getProperty(fieldId).schema.widget.id==='hidden'||formProperty.getProperty(fieldId).schema.widget.ignoreParentSplit)"
          [class.ui-g-nopad]="schema?.widget?.nopad"
          [formProperty]="formProperty.getProperty(fieldId)">
        </sf-form-element>
      </div>
    </div>

    <div *ngIf="!schema.widget.split">
      <sf-form-element *ngFor="let fieldId of fieldset.fields" [formProperty]="formProperty.getProperty(fieldId)">
      </sf-form-element>
    </div>


  </div>
</div>

<ngx-ui-validation-messages *ngIf="formProperty.schema.widget?.showErrors && formProperty.schema.widget?.showErrors?.position==='bottom'" [formComponent]="this"></ngx-ui-validation-messages>

<!--
  Action buttons
-->

<div *ngIf="widgetButtons?.length" class="ui-g-12">
  <div *ngFor="let button of widgetButtons" [class]="button.inline===false?'ui-g-12':''">

      <ngx-ui-button-component
      *ngIf="isButtonVisibile(button, formProperty.valid, formProperty.value)"
      [formProperty]="formProperty" [button]="button"></ngx-ui-button-component>
  </div>
</div>

<div *ngIf="formProperty.schema.links?.length" class="ui-g-12">
  <div *ngFor="let link of formProperty.schema.links" [class]="link.inline===false?'ui-g-12':''">
    <ngx-ui-widget-link [link]="link"
                       [disabled]="isClickableDisabled(link, formProperty.valid)"></ngx-ui-widget-link>
  </div>
</div>
